<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.geometry.Pos?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ProgressBar?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.cell.PropertyValueFactory?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.effect.InnerShadow?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Priority?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.Circle?>
<?import javafx.scene.shape.Rectangle?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.text.Text?>

<AnchorPane xmlns="http://javafx.com/javafx/17"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FinalProject.UMS.TuitionController"
            style="-fx-background-color: linear-gradient(to bottom, #f8f9fa, #e9ecef);"
            AnchorPane.topAnchor="0.0" AnchorPane.rightAnchor="0.0"
            AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0">

    <BorderPane AnchorPane.topAnchor="0.0" AnchorPane.rightAnchor="0.0"
                AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0">

        <!-- Header -->
        <top>
            <VBox spacing="10">
                <padding>
                    <Insets top="15" right="20" bottom="5" left="20"/>
                </padding>

                <!-- Header with Logo -->
                <HBox alignment="CENTER_LEFT" spacing="15">
                    <Circle radius="25" style="-fx-fill: #9B001C;">
                        <effect>
                            <InnerShadow/>
                        </effect>
                    </Circle>
                    <VBox alignment="CENTER_LEFT">
                        <Label text="Tuition Management" style="-fx-text-fill: #9B001C; -fx-font-weight: bold;">
                            <font>
                                <Font name="Arial" size="24" />
                            </font>
                        </Label>
                        <Label text="View and manage your financial information" style="-fx-text-fill: #666666; -fx-font-style: italic;">
                            <font>
                                <Font name="Arial" size="12" />
                            </font>
                        </Label>
                    </VBox>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button fx:id="returnButton" text="Return" onAction="#handleReturnButton"
                            style="-fx-background-color: #9B001C; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 8 15; -fx-background-radius: 5; -fx-cursor: hand;">
                        <graphic>
                            <Text text="ðŸ " style="-fx-font-size: 12;"/>
                        </graphic>
                        <effect>
                            <DropShadow color="#00000040" radius="3" spread="0.03"/>
                        </effect>
                    </Button>
                </HBox>

                <!-- Separator -->
                <Rectangle height="3" style="-fx-fill: #F2BA30; -fx-opacity: 0.6; -fx-arc-width: 3; -fx-arc-height: 3;"/>
            </VBox>
        </top>

        <!-- Main Content -->
        <center>
            <VBox spacing="10">
                <padding>
                    <Insets top="5" right="20" bottom="5" left="20"/>
                </padding>

                <!-- Summary Cards -->
                <HBox spacing="15" VBox.vgrow="NEVER">
                    <!-- Balance Card -->
                    <StackPane style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 10;" HBox.hgrow="ALWAYS">
                        <effect>
                            <DropShadow color="#00000022" radius="5" spread="0.03"/>
                        </effect>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <StackPane>
                                <Circle radius="20" style="-fx-fill: rgba(231, 76, 60, 0.15);"/>
                                <Text text="ðŸ’°" style="-fx-font-size: 16;"/>
                            </StackPane>
                            <VBox spacing="3">
                                <Label text="Current Balance" style="-fx-font-weight: bold; -fx-text-fill: #666666; -fx-font-size: 12;"/>
                                <Label fx:id="currentBalanceLabel" text="50.00" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #e74c3c;"/>
                                <Label fx:id="dueDateLabel" text="Due: April 30, 2024" style="-fx-font-size: 11; -fx-text-fill: #666666;"/>
                            </VBox>
                        </HBox>
                    </StackPane>

                    <!-- Payment Progress Card -->
                    <StackPane style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 10;" HBox.hgrow="ALWAYS">
                        <effect>
                            <DropShadow color="#00000022" radius="5" spread="0.03"/>
                        </effect>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <StackPane>
                                <Circle radius="20" style="-fx-fill: rgba(46, 204, 113, 0.15);"/>
                                <Text text="ðŸ“Š" style="-fx-font-size: 16;"/>
                            </StackPane>
                            <VBox spacing="3">
                                <Label text="Payment Progress" style="-fx-font-weight: bold; -fx-text-fill: #666666; -fx-font-size: 12;"/>
                                <HBox spacing="5" alignment="CENTER_LEFT">
                                    <StackPane>
                                        <Rectangle height="12" width="120" style="-fx-fill: #ecf0f1; -fx-arc-width: 12; -fx-arc-height: 12;"/>
                                        <Rectangle height="12" width="90" style="-fx-fill: #2ecc71; -fx-arc-width: 12; -fx-arc-height: 12;" StackPane.alignment="CENTER_LEFT"/>
                                        <ProgressBar fx:id="paymentProgress" progress="0.75" style="-fx-accent: #2ecc71; -fx-min-width: 120; -fx-pref-height: 12; -fx-opacity: 0;"/>
                                    </StackPane>
                                    <Label text="75%" style="-fx-font-size: 11; -fx-text-fill: #666666;"/>
                                </HBox>
                                <Button fx:id="makePaymentButton" text="Pay Now"
                                        style="-fx-background-color: #2ecc71; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5; -fx-padding: 5 10; -fx-cursor: hand; -fx-font-size: 11;">
                                    <graphic>
                                        <Text text="ðŸ’³" style="-fx-font-size: 11;"/>
                                    </graphic>
                                </Button>
                            </VBox>
                        </HBox>
                    </StackPane>

                    <!-- Term Selection Card -->
                    <StackPane style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 10;" HBox.hgrow="ALWAYS">
                        <effect>
                            <DropShadow color="#00000022" radius="5" spread="0.03"/>
                        </effect>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <StackPane>
                                <Circle radius="20" style="-fx-fill: rgba(52, 152, 219, 0.15);"/>
                                <Text text="ðŸ—“ï¸" style="-fx-font-size: 16;"/>
                            </StackPane>
                            <VBox spacing="3">
                                <Label text="Select Term" style="-fx-font-weight: bold; -fx-text-fill: #666666; -fx-font-size: 12;"/>
                                <ComboBox fx:id="termComboBox" promptText="Spring 2024" style="-fx-min-width: 120; -fx-background-radius: 5; -fx-padding: 2; -fx-font-size: 11;"/>
                                <Button fx:id="viewDetailsButton" text="View Details"
                                        style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5; -fx-padding: 5 10; -fx-cursor: hand; -fx-font-size: 11;">
                                    <graphic>
                                        <Text text="ðŸ“" style="-fx-font-size: 11;"/>
                                    </graphic>
                                </Button>
                            </VBox>
                        </HBox>
                    </StackPane>
                </HBox>

                <!-- Alerts Section -->
                <StackPane style="-fx-background-color: #fff3cd; -fx-background-radius: 8; -fx-padding: 10; -fx-border-color: #ffeeba; -fx-border-radius: 8; -fx-border-width: 1;" VBox.vgrow="NEVER">
                    <VBox fx:id="alertBox" spacing="5">
                        <HBox alignment="CENTER_LEFT" spacing="8">
                            <Text text="âš ï¸" style="-fx-font-size: 14;"/>
                            <Label text="Alerts and Notifications" style="-fx-font-weight: bold; -fx-text-fill: #856404; -fx-font-size: 12;"/>
                        </HBox>
                        <HBox spacing="8">
                            <Region prefWidth="22"/>
                            <Label text="Your tuition payment for Spring 2024 is due in 10 days." style="-fx-text-fill: #856404; -fx-font-size: 11;"/>
                        </HBox>
                    </VBox>
                </StackPane>

                <!-- Main Content Area with Table and Charts -->
                <HBox spacing="10" VBox.vgrow="ALWAYS">
                    <!-- Tuition Table -->
                    <StackPane style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 10;" HBox.hgrow="ALWAYS">
                        <effect>
                            <DropShadow color="#00000022" radius="5" spread="0.03"/>
                        </effect>
                        <VBox spacing="8">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Text text="ðŸ“‹" style="-fx-font-size: 14;"/>
                                <Label text="Payment History" style="-fx-font-weight: bold; -fx-text-fill: #666666; -fx-font-size: 12;"/>
                            </HBox>
                            <TableView fx:id="tuitionTable" style="-fx-background-radius: 5; -fx-border-radius: 5; -fx-border-color: #e0e0e0; -fx-border-width: 1; -fx-font-size: 11;" VBox.vgrow="ALWAYS">
                                <columns>
                                    <TableColumn text="Semester" prefWidth="100">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="semester" />
                                        </cellValueFactory>
                                    </TableColumn>
                                    <TableColumn text="Amount Due" prefWidth="90">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="amountDue" />
                                        </cellValueFactory>
                                    </TableColumn>
                                    <TableColumn text="Amount Paid" prefWidth="90">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="amountPaid" />
                                        </cellValueFactory>
                                    </TableColumn>
                                    <TableColumn text="Status" prefWidth="80">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="status" />
                                        </cellValueFactory>
                                    </TableColumn>
                                </columns>
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                            </TableView>
                        </VBox>
                    </StackPane>

                    <!-- Charts Section -->
                    <VBox spacing="10" HBox.hgrow="ALWAYS">
                        <!-- Payment Status Chart -->
                        <StackPane style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 10;" VBox.vgrow="ALWAYS">
                            <effect>
                                <DropShadow color="#00000022" radius="5" spread="0.03"/>
                            </effect>
                            <VBox spacing="5">
                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Text text="ðŸ“Š" style="-fx-font-size: 14;"/>
                                    <Label text="Payment Status" style="-fx-font-weight: bold; -fx-text-fill: #666666; -fx-font-size: 12;"/>
                                </HBox>
                                <BarChart fx:id="paymentChart" legendVisible="false" animated="false"
                                          style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-font-size: 10;" VBox.vgrow="ALWAYS">
                                    <xAxis>
                                        <CategoryAxis label="Status" style="-fx-font-size: 10; -fx-tick-label-fill: #666666;"/>
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis label="Count" style="-fx-font-size: 10; -fx-tick-label-fill: #666666;"/>
                                    </yAxis>
                                </BarChart>
                            </VBox>
                        </StackPane>

                        <!-- Fee Breakdown Chart -->
                        <StackPane style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 10;" VBox.vgrow="ALWAYS">
                            <effect>
                                <DropShadow color="#00000022" radius="5" spread="0.03"/>
                            </effect>
                            <VBox spacing="5">
                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Text text="ðŸ©" style="-fx-font-size: 14;"/>
                                    <Label text="Fee Breakdown" style="-fx-font-weight: bold; -fx-text-fill: #666666; -fx-font-size: 12;"/>
                                </HBox>
                                <PieChart fx:id="breakdownChart" animated="false" labelsVisible="false"
                                          style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-font-size: 10;" VBox.vgrow="ALWAYS"/>
                            </VBox>
                        </StackPane>
                    </VBox>
                </HBox>
            </VBox>
        </center>

        <!-- Footer -->
        <bottom>
            <HBox alignment="CENTER" style="-fx-padding: 5;">
                <Label text="Â© 2024 University Management System" style="-fx-text-fill: #666666; -fx-font-size: 10;"/>
            </HBox>
        </bottom>
    </BorderPane>
</AnchorPane>