<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.chart.*?>

<?import javafx.scene.control.cell.PropertyValueFactory?>

<VBox xmlns="http://javafx.com/javafx/17"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.FinalProject.UMS.TuitionController"
      spacing="20"
      style="-fx-background-color: #f5f7fa;">

    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <!-- Header Section -->
    <HBox spacing="10" alignment="CENTER_LEFT">
        <Label text="Tuition Management" style="-fx-font-size: 28; -fx-font-weight: bold; -fx-text-fill: #2c3e50;">
            <font>
                <Font name="System Bold" size="28.0" />
            </font>
        </Label>
        <Region HBox.hgrow="ALWAYS"/>
        <Button fx:id="returnButton" text="Return to Dashboard"
                style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 8 15;"
                onAction="#handleReturnButton"/>
    </HBox>

    <!-- Test Scenario Controls -->

    <!-- Summary Cards -->
    <HBox spacing="20">
        <!-- Balance Card -->
        <VBox style="-fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 1); -fx-padding: 15;">
            <Label text="Current Balance" style="-fx-font-weight: bold; -fx-text-fill: #7f8c8d;"/>
            <Label fx:id="currentBalanceLabel" text="50.00" style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: #e74c3c;"/>
            <Label fx:id="dueDateLabel" text="Due: --" style="-fx-font-size: 14; -fx-padding: 5 0 0 0;"/>
        </VBox>

        <!-- Payment Progress Card -->
        <VBox style="-fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 1); -fx-padding: 15;">
            <Label text="Payment Progress" style="-fx-font-weight: bold; -fx-text-fill: #7f8c8d;"/>
            <StackPane style="-fx-padding: 10 0;">
                <ProgressBar fx:id="paymentProgress" progress="0.0" style="-fx-accent: #3498db; -fx-min-width: 200; -fx-pref-height: 20;"/>
            </StackPane>
            <Button fx:id="makePaymentButton" text="Make Payment"
                    style="-fx-background-color: #2ecc71; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5;"/>
        </VBox>

        <!-- Term Selection Card -->
        <VBox style="-fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 1); -fx-padding: 15;">
            <Label text="Select Term:" style="-fx-font-weight: bold; -fx-text-fill: #7f8c8d;"/>
            <ComboBox fx:id="termComboBox" style="-fx-min-width: 150; -fx-background-radius: 5;"/>
            <Button fx:id="viewDetailsButton" text="View Details"
                    style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5; -fx-padding: 5 10;"/>
        </VBox>
    </HBox>

    <!-- Alerts Section -->
    <VBox fx:id="alertBox" spacing="5" style="-fx-background-color: #fff3cd; -fx-background-radius: 10; -fx-padding: 10; -fx-border-color: #ffeeba; -fx-border-radius: 10; -fx-border-width: 1;">
        <Label text="Alerts and Notifications" style="-fx-font-weight: bold; -fx-text-fill: #856404;"/>
        <!-- Alerts will be added dynamically -->
    </VBox>

    <!-- Tuition Table -->
    <TableView fx:id="tuitionTable" style="-fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 1);">
        <columns>
            <TableColumn text="Semester" prefWidth="150">
                <cellValueFactory>
                    <PropertyValueFactory property="semester" />
                </cellValueFactory>
            </TableColumn>
            <TableColumn text="Amount Due" prefWidth="120">
                <cellValueFactory>
                    <PropertyValueFactory property="amountDue" />
                </cellValueFactory>
            </TableColumn>
            <TableColumn text="Amount Paid" prefWidth="120">
                <cellValueFactory>
                    <PropertyValueFactory property="amountPaid" />
                </cellValueFactory>
            </TableColumn>
            <TableColumn text="Status" prefWidth="120">
                <cellValueFactory>
                    <PropertyValueFactory property="status" />
                </cellValueFactory>
            </TableColumn>
        </columns>
        <columnResizePolicy>
            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
        </columnResizePolicy>
    </TableView>

    <!-- Charts Section -->
    <HBox spacing="20">
        <!-- Payment Status Chart -->
        <VBox style="-fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 1); -fx-padding: 15;">
            <Label text="Payment Status" style="-fx-font-weight: bold; -fx-text-fill: #7f8c8d;"/>
            <BarChart fx:id="paymentChart" prefWidth="350" prefHeight="250" legendVisible="false">
                <xAxis>
                    <CategoryAxis label="Status" />
                </xAxis>
                <yAxis>
                    <NumberAxis label="Count" />
                </yAxis>
            </BarChart>
        </VBox>

        <!-- Fee Breakdown Chart -->
        <VBox style="-fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 1); -fx-padding: 15;">
            <Label text="Fee Breakdown" style="-fx-font-weight: bold; -fx-text-fill: #7f8c8d;"/>
            <PieChart fx:id="breakdownChart" prefWidth="350" prefHeight="250"/>
        </VBox>
    </HBox>
</VBox>